# 10	narr: choose how to present self at court
# 11	char: turned away from court, explain why with custom_tooltip
# 20	char: AI decides how to react to meeting the traveler
# 30	char: choose action to impress councilor/ruler you're meeting with

namespace = court_visit

narrative_event = {
	id = court_visit.10
	title = EVTNAME_court_visit
	desc = EVTDESC_court_visit
	picture = GFX_evt_emissary
	is_triggered_only = yes
	
	immediate = {
		location = {
			owner = {
				save_event_target_as = targ_liege
			}
		}
		clear_court_flags_effect = yes
		calc_trade_load_effect = yes
		change_variable = { which = "trav_court_xp" value = 1 }
	}
	
	option = {
		name = EVTOPT_court_healer
		trigger = { check_variable = { which = "trav_miracles" value = 2 } }
		set_character_flag = court_healer
		random_list = {
			20 = {
				custom_tooltip = { text = TXT_court_turn }
				modifier = { factor = 3 has_character_modifier = no_etiquette }
				modifier = { factor = 2 has_character_modifier = no_court_role }
				modifier = { factor = 2 has_character_modifier = no_latin }
				modifier = { factor = 2 has_character_modifier = no_theology }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 2 } }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 5 } }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 10 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_court_xp" value = 20 } }
				modifier = { factor = 0.5 check_variable = { which = "trav_miracles" value = 8 } }
				modifier = { factor = 0.5 check_variable = { which = "trav_miracles" value = 14 } }
				hidden_tooltip = { character_event = { id = court_visit.11 } }
			}
			10 = {
				custom_tooltip = { text = TXT_court_chancellor }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_chancellor } } } }
				modifier = { factor = 4 event_target:targ_liege = { job_chancellor = { health_traits = 1 } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_chancellor = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_chancellor = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_chancellor = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_marshal }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_marshal } } } }
				modifier = { factor = 4 event_target:targ_liege = { job_marshal = { health_traits = 1 } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_marshal = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_marshal = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_marshal = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_marshal = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_marshal = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_steward }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_treasurer } } } }
				modifier = { factor = 4 event_target:targ_liege = { job_treasurer = { health_traits = 1 } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_treasurer = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_treasurer = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_treasurer = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_spymaster }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spymaster } } } }
				modifier = { factor = 4 event_target:targ_liege = { job_spymaster = { health_traits = 1 } } }
				modifier = { factor = 4 check_variable = { which = "trav_heresy" value = 3 } }
				modifier = { factor = 4 check_variable = { which = "trav_heresy" value = 8 } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spymaster = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spymaster = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spymaster = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_chaplain }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spiritual } } } }
				modifier = { factor = 4 event_target:targ_liege = { job_spiritual = { health_traits = 1 } } }
				modifier = { factor = 2 check_variable = { which = "trav_miracles" value = 4 } }
				modifier = { factor = 2 check_variable = { which = "trav_miracles" value = 10 } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spiritual = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spiritual = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spiritual = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spiritual = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spiritual = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_regent }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = no } }
				modifier = { factor = 4 event_target:targ_liege = { regent = { health_traits = 1 } } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { regent = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { regent = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { regent = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_liege }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = yes } }
				modifier = { factor = 4 event_target:targ_liege = { health_traits = 1 } }
				modifier = { factor = 3 check_variable = { which = "trav_miracles" value = 6 } }
				modifier = { factor = 3 check_variable = { which = "trav_miracles" value = 12 } }
				modifier = { factor = 1.5 event_target:targ_liege = { trait = diligent } }
				modifier = { factor = 1.5 event_target:targ_liege = { trait = gregarious } }
				modifier = { factor = 0.7 event_target:targ_liege = { trait = slothful } }
				modifier = { factor = 0.7 event_target:targ_liege = { trait = shy } }
				hidden_tooltip = {
					event_target:targ_liege = { save_event_target_as = targ_meet }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
		}
	}
	
	option = {
		name = EVTOPT_court_engineer
		trigger = {
			NOT = { has_character_modifier = no_battle_xp }
			NOT = { has_character_modifier = no_siegecraft }
		}
		set_character_flag = court_engineer
		random_list = {
			20 = {
				custom_tooltip = { text = TXT_court_turn }
				modifier = { factor = 3 has_character_modifier = no_etiquette }
				modifier = { factor = 2 has_character_modifier = no_court_role }
				modifier = { factor = 2 has_character_modifier = no_wep_training }
				modifier = { factor = 3 has_character_modifier = no_logistics }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 4 } }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 10 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_court_xp" value = 20 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_combat_xp" value = 30 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_combat_xp" value = 40 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_combat_xp" value = 50 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_combat_xp" value = 60 } }
				hidden_tooltip = { character_event = { id = court_visit.11 } }
			}
			10 = {
				custom_tooltip = { text = TXT_court_chancellor }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_chancellor } } } }
				modifier = {
					factor = 0
					NOR = {
						event_target:targ_liege = { job_chancellor = { trait = strategist } }
						event_target:targ_liege = { job_chancellor = { trait = ambitious } }
						event_target:targ_liege = { job_chancellor = { trait = diligent } }
						event_target:targ_liege = { job_chancellor = { trait = genius } }
						event_target:targ_liege = { job_chancellor = { trait = quick } }
						event_target:targ_liege = { job_chancellor = { martial = 12 } }
					}
				}
				hidden_tooltip = {
					event_target:targ_liege = { job_chancellor = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			20 = {
				custom_tooltip = { text = TXT_court_marshal }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_marshal } } } }
				modifier = { factor = 2.5 event_target:targ_liege = { job_marshal = { trait = strategist } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_marshal = { trait = ambitious } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_marshal = { trait = genius } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_marshal = { trait = quick } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_marshal = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_marshal = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_marshal = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_marshal = { trait = shy } } }
				modifier = { factor = 0.5 check_variable = { which = "trav_heresy" value = 2 } }
				modifier = { factor = 1.2 has_character_flag = treatise_siege }
				modifier = { factor = 1.2 has_character_flag = treatise_atlas }
				modifier = { factor = 1.2 has_character_flag = treatise_crypto }
				modifier = { factor = 1.5 has_character_flag = treatise_gunpowder }
				hidden_tooltip = {
					event_target:targ_liege = { job_marshal = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_steward }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_treasurer } } } }
				modifier = {
					factor = 0
					NOR = {
						event_target:targ_liege = { job_treasurer = { trait = strategist } }
						event_target:targ_liege = { job_treasurer = { trait = ambitious } }
						event_target:targ_liege = { job_treasurer = { trait = diligent } }
						event_target:targ_liege = { job_treasurer = { trait = genius } }
						event_target:targ_liege = { job_treasurer = { trait = quick } }
						event_target:targ_liege = { job_treasurer = { martial = 12 } }
					}
				}
				hidden_tooltip = {
					event_target:targ_liege = { job_treasurer = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_spymaster }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spymaster } } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_spymaster = { trait = strategist } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_spymaster = { trait = ambitious } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_spymaster = { trait = genius } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = quick } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spymaster = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spymaster = { trait = shy } } }
				modifier = { factor = 1.5 check_variable = { which = "trav_heresy" value = 2 } }
				modifier = { factor = 1.3 has_character_flag = treatise_atlas }
				modifier = { factor = 1.3 has_character_flag = treatise_crypto }
				hidden_tooltip = {
					event_target:targ_liege = { job_spymaster = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_chaplain }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spiritual } } } }
				modifier = {
					factor = 0
					NOR = {
						event_target:targ_liege = { job_spiritual = { trait = strategist } }
						event_target:targ_liege = { job_spiritual = { trait = ambitious } }
						event_target:targ_liege = { job_spiritual = { trait = diligent } }
						event_target:targ_liege = { job_spiritual = { trait = genius } }
						event_target:targ_liege = { job_spiritual = { trait = quick } }
						event_target:targ_liege = { job_spiritual = { martial = 12 } }
					}
				}
				hidden_tooltip = {
					event_target:targ_liege = { job_spiritual = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_regent }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = no } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = gregarious } } }
				modifier = { factor = 0.5 event_target:targ_liege = { regent = { trait = slothful } } }
				modifier = { factor = 0.5 event_target:targ_liege = { regent = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { regent = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_liege }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = yes } }
				modifier = { factor = 1.5 event_target:targ_liege = { trait = diligent } }
				modifier = { factor = 1.5 event_target:targ_liege = { trait = gregarious } }
				modifier = { factor = 0.5 event_target:targ_liege = { trait = slothful } }
				modifier = { factor = 0.5 event_target:targ_liege = { trait = shy } }
				modifier = { factor = 0.8 check_variable = { which = "trav_heresy" value = 2 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_heresy" value = 6 } }
				modifier = { factor = 1.2 has_character_flag = treatise_siege }
				modifier = { factor = 1.2 has_character_flag = treatise_atlas }
				modifier = { factor = 1.2 has_character_flag = treatise_crypto }
				modifier = { factor = 1.3 has_character_flag = treatise_gunpowder }
				hidden_tooltip = {
					event_target:targ_liege = { save_event_target_as = targ_meet }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
		}
	}
	
	option = {
		name = EVTOPT_court_scholar
		trigger = {
			NOT = { has_character_modifier = no_latin }
			check_variable = { which = "trav_study" value = 2 }
		}
		set_character_flag = court_scholar
		random_list = {
			30 = {
				custom_tooltip = { text = TXT_court_turn }
				modifier = { factor = 3 has_character_modifier = no_etiquette }
				modifier = { factor = 2 has_character_modifier = no_court_role }
				modifier = { factor = 3 has_character_modifier = no_latin }
				modifier = { factor = 2 has_character_modifier = no_rhetoric }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 4 } }
				modifier = { factor = 4 check_variable = { which = "trav_heresy" value = 10 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_court_xp" value = 20 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_study" value = 4 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_study" value = 8 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_study" value = 12 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_study" value = 16 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_study" value = 20 } }
				modifier = { factor = 0.8 check_variable = { which = "owned_manuals" value = 6 } }
				modifier = { factor = 0.8 check_variable = { which = "owned_manuals" value = 12 } }
				hidden_tooltip = { character_event = { id = court_visit.11 } }
			}
			20 = {
				custom_tooltip = { text = TXT_court_chancellor }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_chancellor } } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_chancellor = { trait = genius } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_chancellor = { trait = quick } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_chancellor = { trait = scholar } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_chancellor = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_chancellor = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_chancellor = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_marshal }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_marshal } } } }
				modifier = {
					factor = 0
					NOR = {
						event_target:targ_liege = { job_marshal = { trait = scholar } }
						event_target:targ_liege = { job_marshal = { trait = diligent } }
						event_target:targ_liege = { job_marshal = { learning = 12 } }
					}
				}
				modifier = { factor = 0.5 check_variable = { which = "trav_heresy" value = 2 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_marshal = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			20 = {
				custom_tooltip = { text = TXT_court_steward }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_treasurer } } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_treasurer = { trait = genius } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_treasurer = { trait = quick } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_treasurer = { trait = scholar } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_treasurer = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_treasurer = { trait = shy } } }
				modifier = { factor = 0.5 check_variable = { which = "trav_heresy" value = 2 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_treasurer = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_spymaster }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spymaster } } } }
				modifier = {
					factor = 0
					NOR = {
						event_target:targ_liege = { job_spymaster = { trait = scholar } }
						event_target:targ_liege = { job_spymaster = { trait = genius } }
						event_target:targ_liege = { job_spymaster = { trait = quick } }
						event_target:targ_liege = { job_spymaster = { trait = ambitious } }
						event_target:targ_liege = { job_spymaster = { trait = diligent } }
						event_target:targ_liege = { job_spymaster = { trait = gregarious } }
						event_target:targ_liege = { job_spymaster = { trait = paranoid } }
						event_target:targ_liege = { job_spymaster = { learning = 12 } }
					}
				}
				modifier = { factor = 1.5 check_variable = { which = "trav_heresy" value = 2 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spymaster = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			20 = {
				custom_tooltip = { text = TXT_court_chaplain }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spiritual } } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_spiritual = { trait = genius } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_spiritual = { trait = quick } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_spiritual = { trait = scholar } } }
				modifier = { factor = 3.0 event_target:targ_liege = { job_spiritual = { trait = theologian } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spiritual = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spiritual = { trait = gregarious } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spiritual = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spiritual = { trait = shy } } }
				modifier = { factor = 0.5 check_variable = { which = "trav_heresy" value = 2 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spiritual = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_regent }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = no } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = gregarious } } }
				modifier = { factor = 0.5 event_target:targ_liege = { regent = { trait = slothful } } }
				modifier = { factor = 0.5 event_target:targ_liege = { regent = { trait = shy } } }
				hidden_tooltip = {
					event_target:targ_liege = { regent = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_liege }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = yes } }
				modifier = { factor = 2.0 event_target:targ_liege = { trait = scholar } }
				modifier = { factor = 1.5 event_target:targ_liege = { trait = diligent } }
				modifier = { factor = 1.5 event_target:targ_liege = { trait = gregarious } }
				modifier = { factor = 0.5 event_target:targ_liege = { trait = slothful } }
				modifier = { factor = 0.5 event_target:targ_liege = { trait = shy } }
				modifier = { factor = 1.2 check_variable = { which = "trav_study" value = 6 } }
				modifier = { factor = 1.2 check_variable = { which = "trav_study" value = 10 } }
				modifier = { factor = 1.2 check_variable = { which = "trav_study" value = 14 } }
				modifier = { factor = 1.2 check_variable = { which = "trav_study" value = 18 } }
				modifier = { factor = 1.2 check_variable = { which = "trav_study" value = 22 } }
				modifier = {
					factor = 0.5
					check_variable = { which = "trav_heresy" value = 2 }
					event_target:targ_liege = { NOT = { trait = cynical } }
				}
				modifier = {
					factor = 0.5
					check_variable = { which = "trav_heresy" value = 6 }
					event_target:targ_liege = { NOT = { trait = cynical } }
				}
				modifier = {
					factor = 0.5
					check_variable = { which = "trav_heresy" value = 10 }
					event_target:targ_liege = { NOT = { trait = cynical } }
				}
				hidden_tooltip = {
					event_target:targ_liege = { save_event_target_as = targ_meet }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
		}
	}
	
	option = {
		name = EVTOPT_court_merchant
		trigger = { check_variable = { which = "trav_merchant" value = 10 } }
		set_character_flag = court_merchant
		random_list = {
			40 = {
				custom_tooltip = { text = TXT_court_turn }
				modifier = { factor = 5 NOT = { check_variable = { which = "trade_burden" value = 1 } } }
				modifier = { factor = 3 has_character_modifier = no_etiquette }
				modifier = { factor = 2 has_character_modifier = no_court_role }
				modifier = { factor = 2 has_character_modifier = no_negotiation }
				modifier = { factor = 2 has_character_modifier = no_merchant_xp }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 5 } }
				modifier = { factor = 2 check_variable = { which = "trav_heresy" value = 10 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_court_xp" value = 20 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_merchant" value = 20 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_merchant" value = 40 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_merchant" value = 60 } }
				hidden_tooltip = { character_event = { id = court_visit.11 } }
			}
			10 = {
				custom_tooltip = { text = TXT_court_chancellor }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_chancellor } } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = gregarious } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = greedy } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_chancellor = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_chancellor = { trait = shy } } }
				modifier = { factor = 1.2 check_variable = { which = "trade_burden" value = 6 } }
				modifier = { factor = 1.2 check_variable = { which = "trade_burden" value = 12 } }
				modifier = { factor = 1.6 check_variable = { which = "trade_silk" value = 1 } }
				modifier = { factor = 1.5 check_variable = { which = "trade_spice" value = 1 } }
				modifier = { factor = 1.4 check_variable = { which = "trade_ivory" value = 1 } }
				modifier = { factor = 1.3 check_variable = { which = "trade_furs" value = 1 } }
				modifier = { factor = 1.2 check_variable = { which = "trade_wine" value = 1 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_chancellor = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			15 = {
				custom_tooltip = { text = TXT_court_steward }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_treasurer } } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = gregarious } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = greedy } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_treasurer = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_treasurer = { trait = shy } } }
				modifier = { factor = 1.2 check_variable = { which = "trade_burden" value = 6 } }
				modifier = { factor = 1.2 check_variable = { which = "trade_burden" value = 12 } }
				modifier = { factor = 1.6 check_variable = { which = "trade_silk" value = 1 } }
				modifier = { factor = 1.5 check_variable = { which = "trade_spice" value = 1 } }
				modifier = { factor = 1.4 check_variable = { which = "trade_ivory" value = 1 } }
				modifier = { factor = 1.3 check_variable = { which = "trade_furs" value = 1 } }
				modifier = { factor = 1.2 check_variable = { which = "trade_wine" value = 1 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_treasurer = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_spymaster }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spymaster } } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = diligent } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = paranoid } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spymaster = { trait = slothful } } }
				modifier = { factor = 0.7 event_target:targ_liege = { job_spymaster = { trait = shy } } }
				modifier = { factor = 1.5 check_variable = { which = "trav_heresy" value = 2 } }
				modifier = { factor = 1.5 check_variable = { which = "trav_criminal" value = 5 } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spymaster = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
		}
	}
	
	option = {
		name = EVTOPT_court_assassin
		trigger = {
			trait = gunner
			check_variable = { which = "trav_criminal" value = 1 }
		}
		set_character_flag = court_assassin
		random_list = {
			5 = {
				custom_tooltip = { text = TXT_court_turn }
				modifier = { factor = 3 has_character_modifier = no_etiquette }
				modifier = { factor = 2 has_character_modifier = no_court_role }
				modifier = { factor = 2 has_character_modifier = no_plotting_xp }
				modifier = { factor = 0.8 check_variable = { which = "trav_court_xp" value = 20 } }
				modifier = { factor = 0.8 check_variable = { which = "trav_court_xp" value = 40 } }
				hidden_tooltip = { character_event = { id = court_visit.11 } }
			}
			10 = {
				custom_tooltip = { text = TXT_court_chancellor }
				#custom_tooltip = { text = TXT_kill_targ_chan }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_chancellor } } } }
				modifier = { factor = 0 event_target:targ_liege = { job_chancellor = { has_murder_plot_trigger = no } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_chancellor = { trait = schemer } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_chancellor = { trait = arbitrary } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_chancellor = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_marshal }
				#custom_tooltip = { text = TXT_kill_targ_mar }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_marshal } } } }
				modifier = { factor = 0 event_target:targ_liege = { job_marshal = { has_murder_plot_trigger = no } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_marshal = { trait = schemer } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_marshal = { trait = arbitrary } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_marshal = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_steward }
				#custom_tooltip = { text = TXT_kill_targ_stew }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_treasurer } } } }
				modifier = { factor = 0 event_target:targ_liege = { job_treasurer = { has_murder_plot_trigger = no } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_treasurer = { trait = schemer } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_treasurer = { trait = arbitrary } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_treasurer = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			20 = {
				custom_tooltip = { text = TXT_court_spymaster }
				#custom_tooltip = { text = TXT_kill_targ_spy }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spymaster } } } }
				modifier = { factor = 0 event_target:targ_liege = { job_spymaster = { has_murder_plot_trigger = no } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_spymaster = { trait = schemer } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spymaster = { trait = arbitrary } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spymaster = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_chaplain }
				#custom_tooltip = { text = TXT_kill_targ_spir }
				modifier = { factor = 0 event_target:targ_liege = { NOT = { any_courtier = { count = 1 has_job_title = job_spiritual } } } }
				modifier = { factor = 0 event_target:targ_liege = { job_spiritual = { has_murder_plot_trigger = no } } }
				modifier = { factor = 2.0 event_target:targ_liege = { job_spiritual = { trait = schemer } } }
				modifier = { factor = 1.5 event_target:targ_liege = { job_spiritual = { trait = arbitrary } } }
				hidden_tooltip = {
					event_target:targ_liege = { job_spiritual = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_regent }
				#custom_tooltip = { text = TXT_kill_targ_reg }
				modifier = { factor = 0 event_target:targ_liege = { has_regent = no } }
				modifier = { factor = 0 event_target:targ_liege = { regent = { has_murder_plot_trigger = no } } }
				modifier = { factor = 2.0 event_target:targ_liege = { regent = { trait = schemer } } }
				modifier = { factor = 1.5 event_target:targ_liege = { regent = { trait = arbitrary } } }
				hidden_tooltip = {
					event_target:targ_liege = { regent = { save_event_target_as = targ_meet } }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
			5 = {
				custom_tooltip = { text = TXT_court_liege }
				#custom_tooltip = { text = TXT_kill_targ }
				modifier = { factor = 0 event_target:targ_liege = { has_murder_plot_trigger = no } }
				modifier = { factor = 3.0 event_target:targ_liege = { trait = schemer } }
				modifier = { factor = 2.0 event_target:targ_liege = { trait = arbitrary } }
				hidden_tooltip = {
					event_target:targ_liege = { save_event_target_as = targ_meet }
					event_target:targ_meet = { character_event = { id = court_visit.20 } }
				}
			}
		}
	}
	
	option = {
		name = EVTOPT_court_wander
		set_character_flag = court_wanderer
		random_list = {
			10 = { custom_tooltip = { text = TXT_court_turn } }
		}
	}
}

character_event = {
	id = court_visit.11
	desc = EVTDESC_court_refused
	picture = GFX_evt_emissary
	is_triggered_only = yes
	
	option = {
		name = OK		
		if = {
			limit = { has_character_modifier = no_etiquette }
			custom_tooltip = { text = TXT_court_etiquette }
		}
		if = {
			limit = { has_character_modifier = no_court_role }
			custom_tooltip = { text = TXT_court_role }
		}
		if = {
			limit = { has_character_flag = court_assassin }
			custom_tooltip = { text = TXT_court_noplot }
		}
		if = {
			limit = {
				has_character_flag = court_assassin
				has_character_modifier = no_plotting_xp
			}
			custom_tooltip = { text = TXT_court_plotting }
		}
		if = {
			limit = {
				OR = {
					has_character_flag = court_healer
					has_character_flag = court_scholar
				}
				has_character_modifier = no_latin
			}
			custom_tooltip = { text = TXT_court_latin }
		}
		if = {
			limit = {
				has_character_flag = court_scholar
				has_character_modifier = no_rhetoric
			}
			custom_tooltip = { text = TXT_court_rhetoric }
		}
		if = {
			limit = {
				has_character_flag = court_healer
				has_character_modifier = no_theology
			}
			custom_tooltip = { text = TXT_court_theology }
		}
		if = {
			limit = {
				has_character_flag = court_engineer
				has_character_modifier = no_wep_training
			}
			custom_tooltip = { text = TXT_court_weapons }
		}
		if = {
			limit = {
				has_character_flag = court_engineer
				has_character_modifier = no_logistics
			}
			custom_tooltip = { text = TXT_court_logistics }
		}
		if = {
			limit = {
				has_character_flag = court_merchant
				has_character_modifier = no_negotiation
			}
			custom_tooltip = { text = TXT_court_negotiate }
		}
		if = {
			limit = {
				NOT = { has_character_flag = court_assassin }
				check_variable = { which = "trav_heresy" value = 2 }
			}
			custom_tooltip = { text = TXT_court_heresy }
		}
		if = {
			limit = {
				NOT = { has_character_flag = court_assassin }
				check_variable = { which = "trav_heresy" value = 10 }
			}
			custom_tooltip = { text = TXT_court_heresy_2 }
		}
		if = {
			limit = {
				has_character_flag = court_healer
				NOT = { check_variable = { which = "trav_miracles" value = 6 } }
			}
			custom_tooltip = { text = TXT_court_miracles }
		}
		if = {
			limit = {
				has_character_flag = court_engineer
				NOT = { check_variable = { which = "trav_combat_xp" value = 50 } }
			}
			custom_tooltip = { text = TXT_court_battle_xp }
		}
		if = {
			limit = {
				has_character_flag = court_scholar
				NOT = { check_variable = { which = "owned_manuals" value = 12 } }
			}
			custom_tooltip = { text = TXT_court_manuals }
		}
		if = {
			limit = {
				has_character_flag = court_scholar
				NOT = { check_variable = { which = "trav_study" value = 12 } }
			}
			custom_tooltip = { text = TXT_court_study }
		}
		if = {
			limit = {
				has_character_flag = court_merchant
				OR = {
					has_character_modifier = no_merchant_xp
					NOT = { check_variable = { which = "trav_merchant" value = 40 } }
				}
			}
			custom_tooltip = { text = TXT_court_merchant }
		}
		if = {
			limit = {
				has_character_flag = court_merchant
				NOT = { check_variable = { which = "trade_burden" value = 1 } }
			}
			custom_tooltip = { text = TXT_court_nogoods }
		}
	}
}

character_event = {
	id = court_visit.20
	desc = EVTDESC_debug_court
	picture = GFX_evt_emissary
	is_triggered_only = yes
	
	immediate = {
		clear_event_target = targ_sick
		clear_court_interests_effect = yes
		random_list = {			# choose which treatise this character is interested in
			10 = {
				set_character_flag = interest_siege
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_siege } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_marshal
						FROM = { has_character_flag = court_engineer }
						trait = strategist
					}
				}
				modifier = { factor = 5 trait = strategist }
			}
			10 = {
				set_character_flag = interest_atlas
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_atlas } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_marshal
						has_job_title = job_spymaster
						trait = strategist
					}
				}
				modifier = { factor = 5 trait = strategist }
			}
			10 = {
				set_character_flag = interest_crypto
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_crypto } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_marshal
						has_job_title = job_spymaster
						FROM = { has_character_flag = court_assassin }
						trait = strategist
						trait = schemer
					}
				}
				modifier = { factor = 5 trait = strategist }
				modifier = { factor = 5 trait = schemer }
			}
			10 = {
				set_character_flag = interest_gunpowder
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_gunpowder } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_marshal
					}
				}
			}
			10 = {
				set_character_flag = interest_naval
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_naval } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_treasurer
						FROM = { has_character_flag = court_merchant }
					}
				}
			}
			10 = {
				set_character_flag = interest_agri
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_agri } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_treasurer
						trait = gardener
					}
				}
				modifier = { factor = 5 trait = gardener }
			}
			10 = {
				set_character_flag = interest_steel
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_steel } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_marshal
						has_job_title = job_treasurer
						trait = architect
						trait = administrator
					}
				}
				modifier = { factor = 5 trait = architect }
				modifier = { factor = 5 trait = administrator }
			}
			10 = {
				set_character_flag = interest_distill
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_distill } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_chancellor
						has_job_title = job_treasurer
						trait = hedonist
						trait = drunkard
					}
				}
				modifier = { factor = 5 trait = hedonist }
				modifier = { factor = 5 trait = drunkard }
			}
			10 = {
				set_character_flag = interest_music
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_music } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_chancellor
						has_job_title = job_spiritual
						trait = poet
						trait = socializer
					}
				}
				modifier = { factor = 5 trait = poet }
				modifier = { factor = 5 trait = socializer }
			}
			10 = {
				set_character_flag = interest_medicine
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_medicine } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_chancellor
						has_job_title = job_treasurer
						FROM = { has_character_flag = court_healer }
						trait = scholar
					}
				}
				modifier = { factor = 5 trait = scholar }
			}
			10 = {
				set_character_flag = interest_astronomy
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_astronomy } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_spiritual
						FROM = { has_character_flag = court_scholar }
						trait = mystic
						trait = scholar
					}
				}
				modifier = { factor = 5 trait = mystic }
				modifier = { factor = 5 trait = scholar }
			}
			10 = {
				set_character_flag = interest_games
				modifier = { factor = 0 FROM = { NOT = { has_character_flag = treatise_games } } }
				modifier = { factor = 0
					NOR = {
						has_job_title = job_chancellor
						trait = gamer
					}
				}
				modifier = { factor = 5 trait = gamer }
			}
		}
	}
	
	option = {
		name = OK
		random_list = {
			40 = {
				set_variable = { which = "te_disposition" value = 0 }		# indifferent
				modifier = { factor = 0 has_character_flag = met_traveller }
				modifier = { factor = 0.5 opinion = { who = FROM value = 20 } }
				modifier = { factor = 0.2 opinion = { who = FROM value = 50 } }
				modifier = { factor = 0.5 NOT = { opinion = { who = FROM value = -20 } } }
				modifier = { factor = 0.2 NOT = { opinion = { who = FROM value = -50 } } }
			}
			10 = {
				set_variable = { which = "te_disposition" value = -1 }		# distrustful
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_heresy" value = 3 } } }
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_heresy" value = 10 } } }
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_criminal" value = 3 } } }
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_criminal" value = 10 } } }
				modifier = { factor = 3 NOT = { opinion = { who = FROM value = -10 } } }
				modifier = { factor = 3 NOT = { opinion = { who = FROM value = -35 } } }
			}
			10 = {
				set_variable = { which = "te_disposition" value = -2 }		# annoyed
				modifier = { factor = 0 NOT = { has_character_flag = met_traveller } }
				modifier = { factor = 2 NOT = { opinion = { who = FROM value = 0 } } }
			}
			10 = {
				set_variable = { which = "te_disposition" value = 1 }		# interested
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_miracles" value = 3 } } }
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_miracles" value = 10 } } }
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_study" value = 3 } } }
				modifier = { factor = 1.5 FROM = { check_variable = { which = "trav_study" value = 10 } } }
				modifier = { factor = 2 opinion = { who = FROM value = 10 } }
				modifier = { factor = 2 opinion = { who = FROM value = 35 } }
			}
			100 = {
				set_variable = { which = "te_disposition" value = 2 }		# expectant
				modifier = { factor = 0 has_character_flag = traveller_performed_service }
				modifier = {
					factor = 10
					health_traits = 1
					FROM = { has_character_flag = court_healer }
				}
				modifier = { factor = 2 opinion = { who = FROM value = 0 } }
			}
		}
		set_character_flag = met_traveller
		clr_character_flag = traveller_good
		clr_character_flag = traveller_bad
		FROM = { character_event = { id = court_visit.30 } }
	}
}

character_event = {
	id = court_visit.30
	title = EVTNAME_court_meet
	desc = {
		text = EVTDESC_court_meet_neutral
		trigger = { event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 0 } } }
	}
	desc = {
		text = EVTDESC_court_meet_distrust
		trigger = { event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = -1 } } }
	}
	desc = {
		text = EVTDESC_court_meet_annoyed
		trigger = { event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = -2 } } }
	}
	desc = {
		text = EVTDESC_court_meet_interest
		trigger = { event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 1 } } }
	}
	desc = {
		text = EVTDESC_court_meet_expect_heal
		trigger = {
			has_character_flag = court_healer
			NOT = { has_character_flag = court_visit_perform_service }
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
	}
	desc = {
		text = EVTDESC_court_meet_serve_heal
		trigger = {
			has_character_flag = court_healer
			has_character_flag = court_visit_perform_service
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
	}
	desc = {
		text = EVTDESC_court_meet_expect_eng
		trigger = {
			has_character_flag = court_engineer
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
	}
	desc = {
		text = EVTDESC_court_meet_expect_merch
		trigger = {
			has_character_flag = court_merchant
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
	}
	desc = {
		text = EVTDESC_court_meet_expect_ass
		trigger = {
			has_character_flag = court_assassin
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
	}
	desc = {
		text = EVTDESC_court_meet_grateful
		trigger = { event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 4 } } }
	}
	picture = GFX_evt_emissary
	is_triggered_only = yes
	
	immediate = {
		event_target:targ_liege = {
			random_courtier = {
				limit = {
					event_target:targ_meet = { NOT = { character = PREV } }
					prisoner = no
					health_traits = 1
				}
				save_event_target_as = targ_sick
			}
		}
	}
	
	#option = {
	#	name = EVTOPT_loopback
	#	event_target:targ_meet = { character_event = { id = court_visit.20 } }
	#}
	
	# ******************************************** healing interactions *************************
	option = {
		name = EVTOPT_court_meet_heal
		trigger = {
			has_character_flag = court_healer
			NOT = { has_character_flag = court_visit_perform_service }
			event_target:targ_meet = {
				health_traits = 1
				is_variable_equal = { which = "te_disposition" value = 2 }
			}
		}
		set_character_flag = court_visit_perform_service
		event_target:targ_meet = { save_event_target_as = targ_heal }
		character_event = { id = court_visit.30 }
	}
	
	option = {
		name = EVTOPT_court_meet_heal_other
		trigger = {
			has_character_flag = court_healer
			NOT = { has_character_flag = court_visit_perform_service }
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
			event_target:targ_sick = { health_traits = 1 }
		}
		event_target:targ_sick = { save_event_target_as = targ_heal }
		set_character_flag = court_visit_perform_service
		character_event = { id = court_visit.30 }
	}
	
#	option = {
#		name = EVTOPT_court_meet_heal_noone
#		trigger = {
#			has_character_flag = court_healer
#			NOT = { has_character_flag = court_visit_perform_service }
#			event_target:targ_meet = {
#				NOT = { health_traits = 1 }
#				is_variable_equal = { which = "te_disposition" value = 2 }
#			}
#			event_target:targ_sick = { NOT = { health_traits = 1 } }
#		}
#		event_target:targ_meet = {
#			set_character_flag = traveller_performed_service
#			character_event = { id = court_visit.20 }
#		}
#	}
	
	option = {
		name = EVTOPT_court_meet_cure
		trigger = {
			has_character_flag = court_healer
			has_character_flag = court_visit_perform_service
			check_variable = { which = "owned_medicine" value = 1 }
			event_target:targ_heal = {
				OR = {
					trait = wounded
					trait = ill
					trait = maimed
					trait = depressed
					trait = stressed
					trait = pneumonic 
					trait = leper 
					trait = has_tuberculosis 
					trait = has_typhoid_fever 
					trait = has_typhus 
					trait = has_bubonic_plague
				}
			}
		}
		wealth = -1
		event_target:targ_heal = {
			set_character_flag = traveller_performed_service
		
			if = {
				limit = { trait = wounded }
				remove_trait = wounded
				add_trait = scarred
				set_character_flag = traveller_good
				ROOT = { prestige = 5 piety = 5 }
			}
			if = {
				limit = { trait = ill }
				remove_trait = ill
			}
			if = {
				limit = { trait = maimed }
				random_list = {
					20 = { }
					10 = {
						remove_trait = maimed
						add_trait = scarred
						set_character_flag = traveller_good
						opinion = { modifier = miraculous_cure who = ROOT years = 25 }
						ROOT = {
							prestige = 15 piety = 10
							hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
						}
					}
				}
			}
			if = {
				limit = { trait = depressed }
				random_list = {
					10 = { set_character_flag = traveller_bad }
					10 = {
						remove_trait = depressed set_character_flag = traveller_good
						ROOT = { prestige = 10 piety = 5 }
					}
				}
			}
			if = {
				limit = { trait = stressed }
				random_list = {
					10 = { set_character_flag = traveller_bad }
					10 = { remove_trait = stressed set_character_flag = traveller_good
						ROOT = { prestige = 10 piety = 5 }
					}
				}
			}
			if = {
				limit = { trait = pneumonic }
				random_list = {
					10 = { set_character_flag = traveller_bad }
					10 = {
						remove_trait = pneumonic
						set_character_flag = traveller_good
						opinion = { modifier = miraculous_cure who = ROOT years = 25 }
						ROOT = {
							prestige = 10 piety = 5
							hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
						}
					}
				}
			}
			if = {
				limit = { trait = leper }
				remove_trait = leper
				set_character_flag = traveller_good
				opinion = { modifier = miraculous_cure who = ROOT years = 25 }
				ROOT = {
					prestige = 15 piety = 10
					hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
				}
			}
			if = {
				limit = { trait = has_tuberculosis }
				random_list = {
					10 = { set_character_flag = traveller_bad }
					10 = {
						remove_trait = has_tuberculosis
						set_character_flag = traveller_good
						opinion = { modifier = miraculous_cure who = ROOT years = 25 }
						ROOT = {
							prestige = 10 piety = 5
							hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
						}
					}
				}
			}
			if = {
				limit = { trait = has_typhoid_fever }
				remove_trait = has_typhoid_fever
				set_character_flag = traveller_good
				opinion = { modifier = miraculous_cure who = ROOT years = 25 }
				ROOT = {
					prestige = 10 piety = 5
					hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
				}
			}
			if = {
				limit = { trait = has_typhus }
				remove_trait = has_typhus
				set_character_flag = traveller_good
				opinion = { modifier = miraculous_cure who = ROOT years = 25 }
				ROOT = {
					prestige = 10 piety = 5
					hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
				}
			}
			if = {
				limit = { trait = has_bubonic_plague }
				remove_trait = has_bubonic_plague
				set_character_flag = traveller_good
				opinion = { modifier = miraculous_cure who = ROOT years = 25 }
				ROOT = {
					prestige = 15 piety = 10
					hidden_tooltip = { change_variable = { which = "trav_miracles" value = 1 } }
				}
			}
		}
		clr_character_flag = court_visit_perform_service
		hidden_tooltip = { event_target:targ_meet = { character_event = { id = court_visit.20 } } }
	}
	
	option = {
		name = EVTOPT_court_meet_nocure
		trigger = {
			has_character_flag = court_healer
			has_character_flag = court_visit_perform_service
		}
		prestige = -1
		random = { chance = 50 event_target:targ_heal = { set_character_flag = traveller_bad } }
		clr_character_flag = court_visit_perform_service
		hidden_tooltip = { event_target:targ_meet = { character_event = { id = court_visit.20 } } }
	}
	
	# ******************************************** engineering interactions *************************
	option = {
		name = EVTOPT_court_meet_eng
		trigger = {
			has_character_flag = court_engineer
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
		random_list = {
			10 = {
				custom_tooltip = { text = TXT_court_visit_pleased }
				prestige = 5
				event_target:targ_meet = {
					military_techpoints = 3
					opinion = { modifier = helpful_wanderer who = ROOT years = 25 }
					set_character_flag = traveller_good
				}
				modifier = { factor = 1.5 has_character_flag = treatise_siege }
				modifier = { factor = 1.3 has_character_flag = treatise_atlas }
				modifier = { factor = 1.3 has_character_flag = treatise_crypto }
				modifier = { factor = 1.3 has_character_flag = treatise_gunpowder }
				modifier = { factor = 1.2 has_character_flag = treatise_naval }
				modifier = { factor = 1.2 has_character_flag = treatise_steel }
			}
			20 = {
				custom_tooltip = { text = TXT_court_visit_ambiv }
			}
			10 = {
				custom_tooltip = { text = TXT_court_visit_displeased }
				prestige = -1
				event_target:targ_meet = { set_character_flag = traveller_bad }
				modifier = { factor = 2.0 has_character_modifier = no_logistics }
				modifier = { factor = 1.5 has_character_modifier = no_wep_training }
				modifier = { factor = 1.5 has_character_modifier = no_latin }
				modifier = { factor = 1.2 has_character_modifier = no_rhetoric }
				modifier = { factor = 1.2 has_character_modifier = no_etiquette }
			}
		}
		hidden_tooltip = {
			change_variable = { which = "trav_study" value = 1 }
			change_variable = { which = "trav_combat_xp" value = 1 }
			event_target:targ_meet = {
				set_character_flag = traveller_performed_service
				character_event = { id = court_visit.20 }
			}
		}
	}
	
	# ******************************************** merchant interactions *************************
	option = {
		name = EVTOPT_court_meet_merch
		trigger = {
			has_character_flag = court_merchant
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
		random_list = {
			10 = {
				custom_tooltip = { text = TXT_court_visit_pleased }
				event_target:targ_meet = {
					opinion = { modifier = reasonable_merchant who = ROOT years = 25 }
					set_character_flag = traveller_good
				}
				modifier = { factor = 4.0 check_variable = { which = "trade_silk" value = 1 } }
				modifier = { factor = 3.5 check_variable = { which = "trade_spice" value = 1 } }
				modifier = { factor = 3.0 check_variable = { which = "trade_ivory" value = 1 } }
				modifier = { factor = 2.5 check_variable = { which = "trade_furs" value = 1 } }
				modifier = { factor = 2.0 check_variable = { which = "trade_wine" value = 1 } }
				modifier = { factor = 1.5 check_variable = { which = "trade_goods" value = 1 } }
			}
			10 = {
				custom_tooltip = { text = TXT_court_visit_displeased }
				prestige = -1
				event_target:targ_meet = { set_character_flag = traveller_bad }
			}
		}
		if = {
			limit = { check_variable = { which = "trade_silk" value = 1 } }
			change_variable = { which = "trade_silk" value = -1 }
			wealth = 11
			prestige = 5
		}
		if = {
			limit = { check_variable = { which = "trade_spice" value = 1 } }
			change_variable = { which = "trade_spice" value = -1 }
			wealth = 8
			prestige = 4
		}
		if = {
			limit = { check_variable = { which = "trade_ivory" value = 1 } }
			change_variable = { which = "trade_ivory" value = -1 }
			wealth = 6
			prestige = 3
		}
		if = {
			limit = { check_variable = { which = "trade_furs" value = 1 } }
			change_variable = { which = "trade_furs" value = -1 }
			wealth = 5
			prestige = 2
		}
		if = {
			limit = { check_variable = { which = "trade_wine" value = 1 } }
			change_variable = { which = "trade_wine" value = -1 }
			wealth = 4
			prestige = 1
		}
		if = {
			limit = { check_variable = { which = "trade_goods" value = 1 } }
			change_variable = { which = "trade_goods" value = -1 }
			wealth = 2
		}
		hidden_tooltip = {
			change_variable = { which = "trav_merchant" value = 2 }
			change_variable = { which = "trav_court_xp" value = 1 }
			event_target:targ_meet = {
				set_character_flag = traveller_performed_service
				character_event = { id = court_visit.20 }
			}
		}
	}
	
	# ******************************************** assassin interactions *************************
	option = {
		name = EVTOPT_court_meet_ass1
		trigger = {
			has_character_flag = court_assassin
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
		random_list = {
			10 = {
				custom_tooltip = { text = TXT_court_visit_pleased }
				wealth = 20
				piety = -5
				event_target:targ_meet = {
					plot_target_char = {
						death = {
							death_reason = death_murder
							killer = event_target:targ_meet
						}
					}
					opinion = { modifier = helpful_wanderer who = ROOT years = 25 }
					set_character_flag = traveller_good
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_visit_ambiv }
				wealth = 15
				piety = -2
				event_target:targ_meet = {
					plot_target_char = { add_trait = maimed }
					opinion = { modifier = helpful_wanderer who = ROOT years = 25 }
					hidden_tooltip = { random = { chance = 50 set_character_flag = traveller_good } }
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_visit_displeased }
				wealth = 10
				piety = -2
				prestige = -2
				random = { chance = 50 add_trait = wounded }
				event_target:targ_meet = { set_character_flag = traveller_bad }
			}
		}
		hidden_tooltip = {
			change_variable = { which = "trav_criminal" value = 4 }
			change_variable = { which = "trav_combat_xp" value = 2 }
			change_variable = { which = "trav_court_xp" value = 2 }
			event_target:targ_meet = {
				set_character_flag = traveller_performed_service
				character_event = { id = court_visit.20 }
			}
		}
	}
	
	option = {
		name = EVTOPT_court_meet_ass2
		trigger = {
			has_character_flag = court_assassin
			event_target:targ_meet = { is_variable_equal = { which = "te_disposition" value = 2 } }
		}
		random_list = {
			10 = {
				custom_tooltip = { text = TXT_court_visit_pleased }
				wealth = 8
				piety = -2
				event_target:targ_meet = {
					add_character_modifier = { name = clever_scheme duration = 365 }
					opinion = { modifier = helpful_wanderer who = ROOT years = 25 }
					set_character_flag = traveller_good
				}
			}
			10 = {
				custom_tooltip = { text = TXT_court_visit_displeased }
				wealth = 4
				piety = -1
				random = { chance = 20 add_trait = wounded }
				event_target:targ_meet = { set_character_flag = traveller_bad }
			}
		}
		hidden_tooltip = {
			change_variable = { which = "trav_criminal" value = 2 }
			change_variable = { which = "trav_combat_xp" value = 1 }
			change_variable = { which = "trav_court_xp" value = 2 }
			event_target:targ_meet = {
				set_character_flag = traveller_performed_service
				character_event = { id = court_visit.20 }
			}
		}
	}
	
	# ******************************************** generic interactions *************************
	
	
	option = {
		name = EVTOPT_court_meet_leave
	}
}







